import pefile
import os

file_path = r'C:\KDT_AISEC_DATA\MalwareSamples\KISA-CISC2017-Malware-1st'

def check_pe(filename):
    global file_path
    filename = os.path.join(file_path, filename)
    
    try:
        with pefile.PE(filename) as pe:
            return True
    except pe.PEFormatError as e:
        pass
    
    return False


for filename in os.listdir(file_path):
    target_path = os.path.join(file_path, filename)
    is_pe = check_pe(target_path)
    if is_pe is False:
        os.remove(target_path)
        print(f'{target_path} is not PE file. Removed.')
    